[
  {
    "Id": "574170",
    "ThreadId": "248076",
    "Html": "\r\n<p>Sometimes, accessing Expression.Parameters in EvaluateParameter event may be very usefual. eg.</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>List&lt;Dictionary &lt;<span style=\"color:blue\">string</span>, <span style=\"color:blue\">double</span>&gt;&gt; params_list;]\r\n<span style=\"color:green\">//init ...</span>\r\nDictionary &lt;<span style=\"color:blue\">string</span>, <span style=\"color:blue\">double</span>&gt; <span style=\"color:blue\">params</span> = <span style=\"color:blue\">new</span> Dictionary &lt;<span style=\"color:blue\">string</span>, <span style=\"color:blue\">double</span>&gt;();\r\n<span style=\"color:blue\">params</span>[<span style=\"color:#a31515\">&quot;A&quot;</span>] = 1;\r\n<span style=\"color:blue\">params</span>[<span style=\"color:#a31515\">&quot;B&quot;</span>] = 2;\r\nparams_list.Add(<span style=\"color:blue\">params</span>);\r\n<span style=\"color:blue\">params</span>[<span style=\"color:#a31515\">&quot;A&quot;</span>] =3;\r\n<span style=\"color:blue\">params</span>[<span style=\"color:#a31515\">&quot;B&quot;</span>] = 4;\r\nparams_list.Add(<span style=\"color:blue\">params</span>);\r\n<span style=\"color:green\">//...list add more</span>\r\nExpression expr = <span style=\"color:blue\">new</span> Expression(<span style=\"color:#a31515\">&quot;A&#43;B&quot;</span>);\r\nexpr.EvaluateParameter &#43;= <span style=\"color:blue\">delegate</span> (<span style=\"color:blue\">string</span> name, ParameterArgs arg)\r\n{\r\n    args.Result = params_list[0][name]; <span style=\"color:green\">//index should be dynamic</span>\r\n}\r\n<span style=\"color:blue\">double</span> result = expr.Evaluate();\r\n</pre>\r\n</div>\r\n<p>As the snippet show above, I can evaluate the value associated with the first item of params_list. if we can access expr.Parameters in the delegate, maybe wo can do this</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>expr.EvaluateParameter &#43;= <span style=\"color:blue\">delegate</span> (<span style=\"color:blue\">string</span> name, ParameterArgs arg)\r\n{\r\n    <span style=\"color:blue\">int</span> index = arg.Parameters[<span style=\"color:#a31515\">&quot;index&quot;</span>];\r\n    args.Result = params_list[<span style=\"text-decoration:underline\"><span style=\"color:#000000\"><em><strong>index</strong></em></span></span>][name];</pre>\r\n<pre>}\r\n<span style=\"text-decoration:underline\"><em><strong>expr.Parameters[<span style=\"color:#a31515\">&quot;index&quot;</span>].Value</strong></em></span> = 0;\r\n<span style=\"color:blue\">double</span> result = expr.Evaluate();\r\n\r\nAnd all needed is to add some properties to ParameterArgs class and set value before given to EvaluateParameter event delegate.</pre>\r\n</div>\r\n",
    "PostedDate": "2011-03-01T19:13:12.277-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]